%% The following is a directive for TeXShop to indicate the main file
%%!TEX root = diss.tex

\chapter{Introduction}
\label{ch:Introduction}

\section{Motivation}
\label{sec:Motivation}

\ac{CPS} are embedded systems consisting of software and physical components knitted together and are tightly coupled to the environment in which operate. \ac{CPS} operate by taking as input software commands and environment readings provided by the sensors, as a result they take actions by sending commands to actuator which alters their state and even their environment in some cases. Few applications of \ac{CPS} are smart grids\cite{karnouskos2011cyber, ericsson2010cyber}, autonomous cars\cite{checkoway2011comprehensive, yang2014vehicle}, \ac{UAV}\cite{javaid2012cyber, mohammed2014uavs}, traffic control, HVAC (heating, ventilation and air conditioning), water management systems, smart medical devices and military systems. Lately, CPS have gained ubiquitous popularity among the masses, which has led to abrupt increase in the usage of these devices in our day-to-day life. These \ac{CPS} are different from the typical computer systems because they operate in a physical environment and their properties must conform to laws of physics. Also, \ac{CPS} are built to solve a specific problem and are not multi-purpose like the typical computer systems. Other features which set \ac{CPS} apart from traditional computer systems are, i) \textit{real-time constraints}, \ac{CPS} such as autonomous cars, pace makers or surgical robots have to operate in tight real-time constraints, sometimes even in the order of milliseconds ii) \textit{zero-day attacks}, as the security vulnerabilities of \ac{CPS} are being exploited lately, it leads an attacker to use a zero-day attacks against the system iii) \textit{no human in the loop}, \ac{CPS} such as autonomous car are expected to function flawlessly without any human intervention. With intelligence being added to the systems, it has become more customary to keep the decision making power with the machines  iv) \textit{difficult to update}, manufacturers of \ac{CPS} cannot easily update or replace the hardware or the software present in them. For example, commercial aircraft which is a safety-critical system with extensive and expensive certification requirements, and, v) \textit{performance constraints}, \ac{CPS} are built keeping in mind a particular scenario, they are often lacking in computing aspects such as memory, computational power and battery.

Therefore, due to these constraints and the desire to produce a large number of \ac{CPS} for monetary benefits, the security aspect in them is lagging behind. As a result CPS have been targets of security attacks due to their safety-critical nature and relative lack of protection. The advent of interconnected \ac{CPS} to the Internet (also known as the Internet of Things) has exacerbated their vulnerability as they obviate the need for attackers to have physical access to the \ac{CPS}. Attacks on \ac{CPS} such as the smart grid~\cite{skopik2012survey, liu2012cyber}, smart cars~\cite{checkoway2011comprehensive, woo2015practical} and smart medical devices~\cite{leavitt2010researchers, radcliffe2011hacking} have been demonstrated in the recent past. 
Therefore, there is a compelling need to protect \ac{CPS} from security attacks. 


\section{Threat Model}
\label{sec:threatModel}
{\bf Access}: The term \ac{SUT} in this study is used to represent the system on which the analysis is performed. It is assumed that the attacker has the capability to gain read and write access to the communication channel between the \ac{SUT} and the controller. Using this access, the attacker can modify the contents or add data packets being transferred. This assumption is realistic as previous work~\cite{ericsson2010cyber} has shown that such access is rather easy to get.

Further, it is assumed that the attacker has the \textit{root} access to the \ac{SUT}, which means that the application code can be modified to suit the attacker's needs. However, as an attacker is likely to want to remain stealthy, it is more likely to make small changes to the program rather than large-scale changes such as replacing the entire program with their own. Also, an assumption that the attacker cannot modify the operating system kernel or the device firmware is made. This can be ensured by using code signing or trusted computing hardware if it is available. 

{\bf Capabilities}: It is assumed that the attacker, using access to the communication channel, can perform two types of attacks. The first one is spoofing, where the contents of the data packets can be modified, and the second one is flooding where the number of data packets being sent to the controller can be increased. The attacker can also perform physical attacks on the \ac{CPS}, for example by rebooting it at arbitrary points in time. 
 
For this research, attacks such as network attacks - \ac{DoS} or message dropping attacks - are \textit{not} considered. Also, only attacks that change the correlation between the logical properties are considered. Therefore, attacks which do not create an impact on the logical properties are not considered. 

\section{Approach}
\label{sec:Approach}

\ac{IDS} have been used for protecting computer systems from security attacks, including CPS~\cite{lu2015towards, mitchell2015behavior, bernieri2016testbed}. \ac{IDS} work by monitoring the activity of the system for which they are deployed and raise alarm when they detect a malicious intent. Traditional forms of \ac{IDS} are signature-based, where signatures of known attacks are compared against the operations of the system to identify attacks. Unfortunately, signature-based \ac{IDS} are a poor fit for \ac{CPS} as the attacks are often tailored to each kind of \ac{CPS}, and hence cannot be described by generic signatures. Further, due to the remote and often disconnected nature of their operation, the attack database in \ac{CPS} cannot be updated frequently unlike traditional computer systems. Finally, a motivated attacker can launch hitherto unknown attacks against a \ac{CPS}, thereby evading detection by signature-based schemes. 

In contrast to signature-based \ac{IDS}, anomaly based \ac{IDS} extract a model of a system's behavior and detect any deviations from the extracted model as an attack. Such \ac{IDS} do not need an attack database, and can hence detect hitherto unknown attacks. Because \ac{CPS} have constrained behaviors, it is often straightforward to derive anomaly based \ac{IDS} for them, making these systems a good match for \ac{CPS}. Unfortunately, anomaly based systems exhibit high rates of false-positives in practice, as learning a stable model of the system is often challenging. Therefore, some researchers have proposed using physics-based models for anomaly detection models for intrusion detection in \ac{CPS}~\cite{ mitchell2012specification,mitchell2014adaptive,choudhari2013stability,chen2018learning,zohrevand2016hidden}. The notion is that because \ac{CPS} interact closely with their physical environments, they need to follow laws of physics, which can in turn be used as the detection model. 
Efforts have been made to use the physical properties of the power grid~\cite{choudhari2013stability,paul2014unified}, \ac{UAV}~\cite{mitchell2012specification} and water treatment systems~\cite{adepu2016using} to build a model which represents the expected behavior of the \ac{CPS}. However, in the prior work, the \ac{IDS} is designed specifically for a particular \ac{CPS}. Therefore, the above solutions cannot be easily generalized to other \ac{CPS}, as the process of finding an appropriate model is both time consuming and effort intensive for developers. 

In this work, the {\em logical correlations} among the physical properties of the \ac{CPS} are considered as the model for anomaly-based \ac{IDS}. The hypothesis is that physical properties exhibit deterministic and predictable correlations among themselves, as they have to adhere to the laws of physics. For example, consider the case of an \ac{UAV}, which needs to follow Newton's laws of motion during flight. Some physical properties of an \ac{UAV} are: distance traveled, altitude, speed, battery life left and flight time. When an \ac{UAV} is flying at a fixed altitude, it has a non-zero speed due to which the distance traveled and flight time increases, while the battery life left in the \ac{UAV} decreases. These relationships encompass the logical correlations among the physical properties of the \ac{UAV}. If during flight it is observed that the battery life left in the \ac{UAV} is not decreasing while the speed of the \ac{UAV} is non-zero, this would imply that there is some anomaly in the system, which potentially indicates an attack.

\section{Hidden Markov Models}
\label{sec:HMM_explain}

In this study, an \ac{IDS} is built which internally uses an \ac{HMM} to find logical correlations among the physical variables in a system. \ac{HMM} are useful for systems which can be represented by sequences or time series. An \ac{HMM} is a finite model that can be used to describe a probability distribution over an infinite number of possible sequences in a given system~\cite{eddy1996hidden}.

Unlike a simple Markov model, an \ac{HMM} is composed of a number of hidden states. Each hidden state 'emits' symbols according to emission probabilities, and the states are interconnected by state-transition probabilities. Starting from an initial state, a sequence of states is generated by moving from state to state according to the state-transition probabilities until an end state is reached. Each state then emits symbols according to that state's emission probability distribution, creating an observable sequence of symbols.
More formally, an \ac{HMM} can be represented by ( $\pi$, A, $\theta$) where $\pi$ represents the starting probability of the transitions between the hidden states, while the transition probability matrix is denoted by A and $\theta$ represents the emission probability of the hidden states.

\ac{HMM} are a good fit for problems in which i) the model parameters and observed data are present, and there is a need to estimate the sequence of hidden states; ii) the observed data is given and the model parameters are to be estimated, and iii) the information of model parameters and observed data is present while there is a need to find the likelihood of data. In \ac{CORGIDS}, \ac{HMM} are used for the third kind of problem, i.e., determining the likelihood of current observed data belonging to the predefined model's parameters. In order to do so, the values of correlated physical properties of the system are fed into an \ac{HMM}, which then infers the correlations between them. These correlations are then used to determine the likelihood of the current observed data as stemming from the model and its parameters. Any deviation is signaled as an anomaly and a possible security attack.

\ac{HMM} act as the core of intrusion detection module mainly because they are capable of finding data patterns in high dimensional, non-linear time series based data systems. Also, \ac{HMM} work by creating hidden states and then transitioning between them which is very similar to the operations of \ac{CPS} system, which are typically modeled as state machines.
Unlike techniques such as correlation coefficients, \ac{HMM} are also highly resilient to noise and outliers. 
For instance, Krotofil et al.~\cite{krotofil2015process} use \acf{PCC} to determine correlation for the cluster entropy. \ac{PCC} measures linear correlation among the variables, therefore is not suitable for multidimensional non-linear data. Also the variables undergoing \ac{PCC} must be either based on interval or ratio scale, making this approach much less generic. Chen at el.  \cite{chen2018learning} employ \ac{SVM} to detect an anomaly in a time series based system. Unfortunately, \ac{SVM} do not work well with time series data, because they work with a snapshot of the state and classify it into a class. However, by manipulating the input feature vector to the \ac{SVM} in such a way that it encapsulates the time factor, authors use it for anomaly detection. On the other hand, Aliabadi et al. ~\cite{aliabadi2017artinali} use Frequent Item Set Mining algorithm which does not model the system, but mines the data under different events. Unfortunately, they do not consider the physical properties, except time, of the \ac{CPS}. Iturbe et al. \cite{iturbe2017feasibility} use \ac{PCA} which infers correlation among the variables and is better suited for linear correlations, as it works by generating orthogonal projections. However, for non-linearly correlated data as in our case, \ac{PCA} is not able to find correlations.


\section{Contributions}
\label{sec:Contributions}

This research proposes a generic intrusion detection system capable of detecting security attacks by inferring the logical correlations of the system and checking if they adhere to a predefined framework. \ac{HMM}  are used to automatically infer the logical correlations among the physical properties of the system with no a priori knowledge of the physical laws adhered to by the system or any intervention by the programmer. The \ac{HMM} identifies a state as malicious by detecting either an undesired data correlation or lack of an expected data correlation among its physical properties. \ac{HMM} are used as they are good at detecting outliers, and are typically used to model time-based systems(~\autoref{sec:HMM_explain}).  
Though other papers have used logical correlations to detect anomalies~\cite{iturbe2017feasibility,krotofil2015process,chen2018learning,zohrevand2016hidden}, none of them have used \ac{HMM} as the core to build a generic \ac{IDS}. \textit{To the best of our knowledge, \ac{CORGIDS} is the first generic intrusion detection system which uses \ac{HMM} to infer logical correlations exhibited by the system to determine if an intrusion has occurred.} Our contributions are:

\begin{enumerate}

\item Proposition of the use of logical correlations exhibited by the physical properties of a \ac{CPS} to detect intrusions, and use \acf{HMM} to infer the logical correlations.

\item Designed a \acf{CORGIDS} prototype using \acf{HMM} to detect intrusions. Also, demonstrated its use on two behaviorally different \ac{CPS} test-beds, namely i) an \ac{UAV}, and ii) a \acf{SAP}.

\item Evaluated the effectiveness of \ac{CORGIDS} by performing five targeted attacks (~\autoref{ch:Attacks}) on the above mentioned \ac{CPS}. Found that \ac{CORGIDS} is successfully able to detect all five attacks, and has lower \acf{FP} and \acf{FN} rate than other intrusion detection techniques (described in ~\autoref{sec6:Evaluation}).

\item Performed a comprehensive comparison with techniques in the related work which design a generic IDS to detect intrusion. Results exhibits that \ac{CORGIDS} achieves significantly lower \ac{FP} and \ac{FN} for both targeted and arbitrary attacks (expect artificial delay insertion attack) when compared to the related work. This comparison and its results are described in ~\autoref{ch:comparisonwithrelatedwork}.

\end{enumerate}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
